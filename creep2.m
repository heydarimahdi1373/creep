clc;
clear all;
close all;
T=[3.42893	3.5956	3.76747	3.93416	4.06439	4.17897	4.30924	4.36655	4.40824	4.43953	4.45525	4.47097	4.47627	4.48161	4.4869	4.48701	4.49754	4.50288	4.503	4.50317	4.50334	4.5037	4.5144	4.51455	4.51472	4.51478	4.52531	4.53579	4.54624];
C=[2.48E-11	2.48E-11	2.49E-11	2.51E-11	2.54E-11	2.54E-11	2.62E-11	2.65E-11	2.67E-11	2.72E-11	2.85E-11	2.98E-11	3.11E-11	3.29E-11	3.39E-11	3.54E-11	3.69E-11	3.87E-11	4.03E-11	4.26E-11	4.49E-11	4.97E-11	5.35E-11	5.56E-11	5.79E-11	5.87E-11	6.02E-11	6.10E-11	6.15E-11];
e=2.718281828;
n=numel(C);
X=(e.^-(T'./T))';
X(n,:)=1;
a=pinv(X')*C';

c=zeros(1,n);
for i=1:n
    for j=1:n-1
        c(i)=c(i)+a(j)*e^-(T(i)/T(j));
    end
    c(i)=c(i)+a(n);
end

X=(e.^-(T./T'));
X(n,:)=1;
BB=zeros(n,1);
F=zeros(n,n);
for i=1:n
    for j=1:n
        for k=1:n
            F(i,j)=F(i,j)+X(i,k)*X(j,k);
        end
        BB(i)=BB(i)+X(i,j)*C(j);
    end
end
r=pinv(F)*BB;

c1=zeros(1,n);
for i=1:n
    for j=1:n-1
        c1(i)=c1(i)+r(j)*e^-(T(i)/T(j));
    end
    c1(i)=c1(i)+r(n);
end

f = fit(T',C','poly2');


p=[-6.944e-07 2.531e-05 -0.0004097 0.003864 -0.0234 0.09438 -0.2535 0.4371 -0.4392 0.1959];
q=@(x) p(1)*x^9+p(2)*x^8+p(3)*x^7+p(4)*x^6+p(5)*x^5+p(6)*x^4+p(7)*x^3+p(8)*x^2+p(9)*x^1+p(10)
for i=1:n
    Q(i)=q(T(i));
end
plot(T,C)
hold on
plot(f,T,C)